# GCNet 

## 1. 主要工作

提出GC block并将该模块应用到骨干网络中。而GC block的提出，是由NL block和SE block结合而来

NL block的提出：事实证明，捕获远距离依赖性有益于各种识别任务，而传统的卷积神经网络中，卷积层在局部区域建立像素关系，远距离依赖只能通过堆叠卷积层来进行建模。但是该方法的计算量大且效率低下。为解决该问题，提出了NL block，该方法可以捕获远程依赖关系，并通过注意力机制进行建模。
简化NL block： 通过实验发现对于不同查询位置的注意力图几乎相同，说明该注意力图所学习的依赖关系与查询位置无关。基于该发现来简化 NL block。

通过简化后的NL block，可以得出一个三步通用框架：
（1）上下文建模块：形成上下文相关的特征；
（2）特征转换模块：用于捕获通道方式的依赖关系；
（3）融合模块：将全局上下文特征融合到所有位置的特征中。

对Non-Local的改进。NL模块中其实包含了一个自注意的操作，计算复杂。但是因为基于不同查询位置的注意力图几乎相同，所以选择通过计算全局注意力图并为所有位置共享。

![简化后的NLblock](E:\桌面\github\paddle\attention\GCNet\简化后的NLblock.png)

进一步将Wv移至注意力层外，则可以进一步减少计算消耗。形成下面的结构：

![20210126111346660](E:\桌面\github\paddle\attention\GCNet\20210126111346660.png)

最终的GCNet模块是简化版的non-local和SE模块机制的结合。

![20210126111812534](E:\桌面\github\paddle\attention\GCNet\20210126111812534.png)